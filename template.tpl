___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "BIGO",
  "brand": {
    "id": "brand_dummy",
    "displayName": "自定义模板",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "BIGO Ads",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "id",
    "displayName": "id",
    "simpleValueType": true,
    "help": "Insert your \u003cstrong\u003epixel_id\u003c/strong\u003e parameter here.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const encodeUriComponent = require('encodeUriComponent');
const id = encodeUriComponent(data.id);
const trackingUrl = 'https://gray-api.imotech.video/ad/events.js?pixel_id=' + id ;
injectScript(trackingUrl, data.gtmOnSuccess, data.gtmOnFailure);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: gtmOnSuccess is invoked on injectScript success
  code: |-
    // test that gtmOnSuccess() is called when injectScript succeeds
    mock('injectScript', (url, onSuccess, onFailure) => {
      onSuccess();
    });

    // Call runCode to run the template's code.
    runCode();

    // Verify that the tag finished successfully.
    assertApi('gtmOnSuccess').wasCalled();
- name: gtmOnFailure is invoked when injectScript fails
  code: |-
    // test gtmOnFailure() is called when injectScript fails
    mock('injectScript', (url, onSuccess, onFailure) => {
      onFailure();
    });

    // Call runCode to run the template's code.
    runCode();

    // Verify onFailure was called
    assertApi('gtmOnFailure').wasCalled();


___NOTES___

Created on 2021/5/19下午2:45:38


